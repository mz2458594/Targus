<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear cuenta</title>

    <link rel="stylesheet" th:href="@{/css/crear_cuenta.css}">
    <link rel="icon" th:href="@{/images/logo.png}">
</head>

<body>

    <div class="main-container">
        <div class="illustration-side">
            <div class="logo-container">
                <img th:src="@{/images/logo.png}" alt="Logo" class="logo">
            </div>
            <div class="illustrations">
                <div class="illustration-item top-right">
                    <div class="avatar">
                        <img src="https://static.grupojoly.com/clip/06db8897-19f6-4b74-a6ce-7811568269ec_source-aspect-ratio_1600w_0.jpg"
                            alt="Avatar 1">
                    </div>
                </div>
                <div class="illustration-item left">
                    <div class="avatar">
                        <img src="https://img.freepik.com/vector-premium/ilustracion-vector-grafico-personaje-dibujos-animados-registro-linea_516790-1808.jpg"
                            alt="Avatar 2">
                    </div>
                </div>
                <div class="illustration-item bottom-right">
                    <div class="avatar">
                        <img src="https://img.freepik.com/vector-premium/chica-dibujos-animados-compra-tecnologia-linea-sitio-web-computadora-portatil-ventas-estacionales-tiendas-linea-grandes-ventas-descuentos-compras-internet-eleccion-ropa-productos-nuevos-forma-remota-vector_776652-2602.jpg"
                            alt="Avatar 3">
                    </div>
                </div>
            </div>
        </div>

        <div class="form-side">
            <div class="nav-links">
                <a th:href="@{/targus/principal/iniciar_crear}" class="enlaces">Iniciar sesion</a> |
                <a th:href="@{/targus/principal/form_crear}" class="enlaces">Crear cuenta</a>
            </div>

            <div class="container">
                <h2 id="titulo">Crea tu cuenta</h2>
                <form th:action="@{/targus/usuario/form_crear}" method="POST">
                    <fieldset>
                        <hr><br>
                        <div th:if="${error != null}">
                            *<span style="font-weight: bold; text-align: center;" th:text="${error}">Error al ingresar
                                el usuario</span>
                            <br><br>
                        </div>
                        <div class="form-row">
                            <label for="fecha_nac">Fecha de nacimiento:</label>
                            <input type="date" id="fecha_nac" name="fecha_nac" required>
                        </div>

                        <script>
                            const inputFecha = document.getElementById("fecha_nac")
                            const today = new Date();
                            // Restamos 18 años a la fecha actual
                            const year = today.getFullYear() - 18;
                            const month = String(today.getMonth() + 1).padStart(2, '0'); // Los meses van de 0 a 11
                            const day = String(today.getDate()).padStart(2, '0');

                            // Armamos la fecha límite permitida
                            const maxDate = `${year}-${month}-${day}`;

                            // Solo se podrá elegir hasta esa fecha (o sea, gente de 18 a más)
                            inputFecha.max = maxDate;
                        </script>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="nombre">Nombre:</label>
                                <input type="text" class="soloText" id="nombre" pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+"
                                    name="nombre" required>
                            </div>
                            <div class="form-group">
                                <label for="apellido">Apellidos:</label>
                                <input type="text" class="soloText" id="apellido" name="apellido" required>
                            </div>
                        </div>


                        <div class="form-row">
                            <div class="form-group">
                                <label for="num_documento">Num documento:</label>
                                <input type="text" class="soloNum" id="num_documento" name="num_documento"
                                    title="El DNI debe tener 8 dígitos" placeholder="Número de Documento" maxlength="8"
                                    required>
                            </div>
                            <div class="form-group">
                                <label for="celular">Celular:</label>
                                <input type="tel" class="soloNum" id="celular" name="celular" required maxlength="9">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="calle">Calle:</label>
                                <input class="text" type="text" id="calle" name="calle">
                            </div>
                            <div class="form-group">

                                <label for="departamento">Departamento:</label>
                                <input type="text" id="departamento" name="departamento">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="distrito">Distrito:</label>
                                <input class="soloText" type="text" id="distrito" name="distrito">
                            </div>
                            <div class="form-group">
                                <label for="provincia">Provincia:</label>
                                <input class="soloText" type="text" id="provincia" name="provincia">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="username">Nombre de Usuario:</label>
                                <input class="soloText" type="text" id="username" name="username" required>
                                <small id="mensaje-error"></small>
                            </div>
                            <div class="form-group">
                                <label for="correo">Correo Electrónico:</label>
                                <input type="email" id="correo" name="correo" required>
                                <small id="mensaje-error"></small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="contraseña">Contraseña:</label>
                                <input type="password" id="contraseña" name="contraseña" required>
                                <ul id="vali_contra">
                                    <li id="req-longitud" class="invalido">Mínimo 8 caracteres</li>
                                    <li id="req-mayuscula" class="invalido">Al menos una mayúscula</li>
                                    <li id="req-minuscula" class="invalido">Al menos una minúscula</li>
                                    <li id="req-numero" class="invalido">Al menos un número</li>
                                </ul>
                            </div>

                            <div class="form-group">
                                <label for="confirmar_contrasena">Confirmar contraseña:</label>
                                <input type="password" id="confirmar_contrasena" name="confirmar_contrasena" required>
                            </div>
                        </div>


                        <br>
                        <input id="boton_crear" type="submit">
                    </fieldset>
                </form>
            </div>
        </div>
    </div>


    <!-----------------------INICIO NOTIFICACIONES DE ERRORES--------------------------------->
    <script>
        const inputPass = document.getElementById('contraseña');
        const requisitos = document.getElementById('vali_contra');

        // Mostrar requisitos al enfocar
        inputPass.addEventListener('focus', () => {
            requisitos.style.display = 'block';
        });

        // Ocultar al salir del campo (opcional)
        inputPass.addEventListener('blur', () => {
            requisitos.style.display = 'none';
        });

        // Validación en tiempo real
        inputPass.addEventListener('input', function () {
            const valor = inputPass.value;

            const longitud = valor.length >= 8;
            const mayuscula = /[A-Z]/.test(valor);
            const minuscula = /[a-z]/.test(valor);
            const numero = /[0-9]/.test(valor);

            actualizarEstado('req-longitud', longitud, 'Mínimo 8 caracteres');
            actualizarEstado('req-mayuscula', mayuscula, 'Al menos una mayúscula');
            actualizarEstado('req-minuscula', minuscula, 'Al menos una minúscula');
            actualizarEstado('req-numero', numero, 'Al menos un número');
        });

        // Función para actualizar los requisitos
        function actualizarEstado(id, cumple, texto) {
            const el = document.getElementById(id);
            if (cumple) {
                el.classList.remove('invalido');
                el.classList.add('valido');
            } else {
                el.classList.remove('valido');
                el.classList.add('invalido');
            }
        }
    </script>

    <script>
        document.querySelector("form").addEventListener("submit", function (e) {
            const password = document.getElementById("contraseña").value;
            const repassword = document.getElementById("confirmar_contrasena").value;

            if (password !== repassword) {
                e.preventDefault();
                alert("Las contraseñas no coinciden.");
            }
        });
    </script>

    <script th:src="@{/js/validacionesInput.js}"></script>

</body>

</html>